<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>FINZN - Tu CompaÃ±ero Financiero Inteligente</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700;800;900&family=Nunito:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.js"></script>
  <script type="module" crossorigin src="./assets/index-BbK4ak1x.js"></script>
  <link rel="stylesheet" crossorigin href="./assets/index-E2iXmVdn.css">
</head>
<body>
  <!-- Alert System -->
  <div id="alert-container" class="alert-container"></div>
  
  <!-- Login Container -->
  <div id="login-container" class="auth-container">
    <div class="auth-card">
      <div class="auth-header">
        <div class="auth-logo">
          <div class="finzn-logo-main">
            <img src="/ChatGPT Image Jul 2, 2025, 10_45_30 PM.png" alt="FINZN Mascot" width="120" height="120" style="border-radius: 50%; box-shadow: 0 8px 32px rgba(183, 166, 255, 0.3);" />
          </div>
          <h1 class="auth-title">FINZN</h1>
        </div>
        <p class="auth-subtitle">Tu compaÃ±ero financiero inteligente</p>
        <p class="auth-description">Gestiona tus finanzas de manera simple y divertida</p>
      </div>
      
      <form id="login-form" class="auth-form">
        <div class="input-group">
          <input type="email" id="login-user" name="username" placeholder="Email" required autocomplete="email" />
        </div>
        <div class="input-group">
          <input type="password" id="login-pass" name="password" placeholder="ContraseÃ±a" required autocomplete="current-password" />
        </div>
        <button type="submit" class="btn btn-primary btn-full">
          <span>âœ¨</span>
          Iniciar SesiÃ³n
        </button>
        <div id="login-error" class="error-message"></div>
      </form>
      
      <div class="auth-footer">
        <p>Â¿No tienes cuenta? <button type="button" id="show-register" class="link-btn">RegÃ­strate aquÃ­</button></p>
      </div>
    </div>
  </div>

  <!-- Register Container -->
  <div id="register-container" class="auth-container hidden">
    <div class="auth-card">
      <div class="auth-header">
        <div class="auth-logo">
          <div class="finzn-logo-main">
            <img src="/ChatGPT Image Jul 2, 2025, 10_45_30 PM.png" alt="FINZN Mascot" width="120" height="120" style="border-radius: 50%; box-shadow: 0 8px 32px rgba(183, 166, 255, 0.3);" />
          </div>
          <h1 class="auth-title">Â¡Bienvenido!</h1>
        </div>
        <p class="auth-subtitle">Ãšnete a FINZN</p>
        <p class="auth-description">Comienza tu viaje hacia la libertad financiera</p>
      </div>
      
      <form id="register-form" class="auth-form">
        <div class="input-group">
          <input type="email" id="register-user" name="username" placeholder="Email" required autocomplete="email" />
          <small class="input-hint">Usa un email Ãºnico, por ejemplo: tu.nombre@gmail.com</small>
        </div>
        <div class="input-group">
          <input type="password" id="register-pass" name="password" placeholder="ContraseÃ±a" required autocomplete="new-password" />
          <small class="input-hint">MÃ­nimo 6 caracteres</small>
        </div>
        <div class="input-group">
          <button type="button" id="generate-test-email" class="btn btn-secondary btn-sm">
            ğŸ² Generar email de prueba
          </button>
        </div>
        <button type="submit" class="btn btn-primary btn-full">
          <span>ğŸš€</span>
          Crear Cuenta
        </button>
        <div id="register-error" class="error-message"></div>
      </form>
      
      <div class="auth-footer">
        <p>Â¿Ya tienes cuenta? <button type="button" id="show-login" class="link-btn">Inicia sesiÃ³n</button></p>
      </div>
    </div>
  </div>
  
  <!-- Main Application -->
  <div id="app" class="app hidden">
    <!-- Header -->
    <header class="header">
      <div class="header-content">
        <div class="header-left">
          <div class="logo-container">
            <div class="finzn-logo-header">
              <img src="./isotipo.png" alt="FINZN Logo" class="logo-icon" />
            </div>
            <h1 class="logo">FINZN</h1>
          </div>
          <div class="user-info">
            <span id="user-name"></span>
          </div>
          <button id="theme-toggle" class="btn btn-icon" title="Cambiar tema">
            <span class="theme-icon">ğŸŒ™</span>
          </button>
          <button id="logout-btn" class="btn btn-secondary logout-btn" title="Cerrar sesiÃ³n">
            <span>ğŸ‘‹</span>
            <span class="logout-text">Salir</span>
          </button>
        </div>
      </div>
    </header>

    <!-- Dashboard with New Layout -->
    <main class="dashboard-new">
      <!-- Sidebar Navigation -->
      <aside class="sidebar-nav">
        <nav class="nav-menu">
          <!-- Primary Navigation -->
          <div class="nav-group primary-nav">
            <div class="nav-item active" data-section="dashboard">
              <div class="nav-icon">ğŸ“Š</div>
              <span class="nav-label">Resumen</span>
            </div>
            <div class="nav-item" data-section="transactions">
              <div class="nav-icon">ğŸ’³</div>
              <span class="nav-label">Transacciones</span>
              <div class="nav-badge" id="pending-transactions">0</div>
            </div>
            <div class="nav-item" data-section="goals">
              <div class="nav-icon">ğŸ¯</div>
              <span class="nav-label">Objetivos</span>
            </div>
            <div class="nav-item" data-section="calendar">
              <div class="nav-icon">ğŸ“…</div>
              <span class="nav-label">Calendario</span>
              <div class="nav-badge" id="upcoming-events">0</div>
            </div>
            <div class="nav-item" data-section="budgets">
              <div class="nav-icon">ğŸ’°</div>
              <span class="nav-label">Presupuestos</span>
              <div class="nav-badge" id="active-budgets">0</div>
            </div>
          </div>
          
          <!-- Secondary Navigation -->
          <div class="nav-divider"></div>
          <div class="nav-group secondary-nav">
            <div class="nav-item" data-section="reports">
              <div class="nav-icon">ğŸ“ˆ</div>
              <span class="nav-label">Reportes</span>
            </div>
            <div class="nav-item" data-section="settings">
              <div class="nav-icon">âš™ï¸</div>
              <span class="nav-label">ConfiguraciÃ³n</span>
            </div>
          </div>
          
          <!-- Mobile Menu Toggle -->
          <button class="mobile-menu-toggle" id="mobile-menu-toggle">
            <div class="nav-icon">ğŸ“Š</div>
            <span class="nav-label">MenÃº</span>
          </button>
        </nav>
        
      </aside>

      <!-- Main Content Area -->
      <div class="main-dashboard">
        <!-- Dashboard Section -->
        <section id="dashboard-section" class="dashboard-section active">
          <!-- Breadcrumb Navigation -->
          <nav class="breadcrumb-nav">
            <span class="breadcrumb-item active">ğŸ“Š Resumen General</span>
          </nav>
          
          <div class="dashboard-grid">
            <!-- Primera fila: Balance, Ingresos, Gastos -->
            <div class="summary-cards">
              <div class="summary-card balance-card-new">
                <div class="card-header-simple">
                  <div class="card-icon-simple">ğŸ’°</div>
                  <span class="card-title">Balance</span>
                </div>
                <div class="card-amount balance-amount-new" id="balance-amount-new">$2,750</div>
                <div class="installments-info">
                  <button id="installments-btn" class="installments-button" onclick="window.app.showInstallmentsModal()">
                    <span id="installments-count">0</span> cuotas activas
                  </button>
                </div>
              </div>

              <div class="summary-card income-card">
                <div class="card-header-simple">
                  <div class="card-icon-simple">ğŸ’µ</div>
                  <span class="card-title">
                    Ingresos
                    <button id="incomes-indicator" class="incomes-indicator" title="Ver historial de ingresos del mes">
                      <span class="indicator-count">0</span>
                    </button>
                  </span>
                </div>
                <div class="card-amount" id="income-summary">$3,500</div>
                <div class="card-action">
                  <button id="add-income-btn-dashboard" class="btn btn-primary">
                    <span>â•</span>
                    Agregar Ingreso
                  </button>
                </div>
              </div>

              <div class="summary-card expenses-card">
                <div class="card-header-simple">
                  <div class="card-icon-simple">ğŸ’³</div>
                  <span class="card-title">Gastos del Mes</span>
                </div>
                <div class="card-amount" id="monthly-expenses-summary">$1,200</div>
                <div class="card-action">
                  <button id="add-expense-btn-dashboard" class="btn btn-primary">
                    <span>â•</span>
                    Agregar Gasto
                  </button>
                </div>
              </div>
            </div>

            <!-- Segunda fila: GrÃ¡fico ocupando toda la horizontal -->
            <div class="chart-section">
              <div class="chart-card-new">
                <h3>ğŸ“Š DistribuciÃ³n de Gastos del Mes</h3>
                <div class="chart-content-with-mascot">
                  <div class="chart-container-new">
                    <canvas id="expenses-chart"></canvas>
                  </div>
                  <div class="chart-mascot">
                    <div class="chart-mascot-container">
                      <img src="./mascota-finzn.png" alt="FINZN Mascota" class="chart-mascot-img" />
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
          </div>
        </section>

        <!-- Transactions Section (Renamed from Expenses) -->
        <section id="transactions-section" class="dashboard-section">
          <nav class="breadcrumb-nav">
            <a href="#" class="breadcrumb-item" data-section="dashboard">ğŸ“Š Resumen</a>
            <span class="breadcrumb-separator">â€º</span>
            <span class="breadcrumb-item active">ğŸ’³ Transacciones</span>
          </nav>
          
          <div class="section-content">
            <div class="section-header">
              <h1>GestiÃ³n de Transacciones</h1>
              <div class="section-actions">
                <button id="add-expense-btn-transactions" class="btn btn-primary">
                  <span>â•</span>
                  Nuevo Gasto
                </button>
                <button id="add-income-btn-transactions" class="btn btn-secondary">
                  <span>ğŸ’°</span>
                  Nuevo Ingreso
                </button>
              </div>
            </div>
            
            <!-- Transaction Tabs -->
            <div class="transaction-tabs">
              <button class="tab-btn active" data-tab="expenses">Gastos</button>
              <button class="tab-btn" data-tab="income">Ingresos</button>
              <button class="tab-btn" data-tab="limits">LÃ­mites</button>
            </div>
            
            <div class="transactions-container">
              <div class="tab-content active" id="expenses-tab">
                <div class="expenses-section-card">
                  <div class="card-header">
                    <h3>ğŸ’³ Gastos del Mes</h3>
                  </div>
                  <div id="expenses-list" class="expenses-list">
                    <!-- Expenses will be loaded here -->
                  </div>
                </div>
              </div>
              
              <div class="tab-content" id="income-tab">
                <div class="income-section-card">
                  <div class="card-header">
                    <h3>ğŸ’° Ingresos del Mes</h3>
                  </div>
                  <div id="income-list" class="income-list">
                    <!-- Income will be loaded here -->
                  </div>
                </div>
              </div>
              
              <div class="tab-content" id="limits-tab">
                <div class="expenses-section-card spending-limits-main-card">
                  <div class="card-header">
                    <h3>ğŸš¦ LÃ­mites Presupuestarios</h3>
                    <button id="add-spending-limit-btn-transactions" class="btn btn-primary btn-sm">
                      <span>â•</span>
                      Nuevo LÃ­mite
                    </button>
                  </div>
                  <div id="category-limits-display" class="category-limits-display">
                    <!-- Spending limits will be loaded here -->
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>


        <!-- Goals Section (Renamed from Savings) -->
        <section id="goals-section" class="dashboard-section">
          <nav class="breadcrumb-nav">
            <a href="#" class="breadcrumb-item" data-section="dashboard">ğŸ“Š Resumen</a>
            <span class="breadcrumb-separator">â€º</span>
            <span class="breadcrumb-item active">ğŸ¯ Objetivos</span>
          </nav>
          
          <div class="section-content">
            <div class="section-header">
              <h1>Objetivos de Ahorro</h1>
              <div class="section-actions">
                <button id="add-goal-btn" class="btn btn-primary">
                  <span>ğŸ¯</span>
                  Nuevo Objetivo
                </button>
              </div>
            </div>
            
            <div id="goals-list" class="goals-list">
              <!-- Goals will be loaded here -->
            </div>
          </div>
        </section>

        <!-- Reports Section (Renamed from Achievements) -->
        <section id="reports-section" class="dashboard-section">
          <nav class="breadcrumb-nav">
            <a href="#" class="breadcrumb-item" data-section="dashboard">ğŸ“Š Resumen</a>
            <span class="breadcrumb-separator">â€º</span>
            <span class="breadcrumb-item active">ğŸ“ˆ Reportes</span>
          </nav>
          
          <div class="section-content">
            <div class="section-header">
              <h1>Reportes y AnÃ¡lisis</h1>
              <div class="section-actions">
                <button id="generate-report-btn-section" class="btn btn-primary">
                  <span>ğŸ¤–</span>
                  Generar Reporte IA
                </button>
              </div>
            </div>
            
            <div class="reports-grid">
              <div class="report-card">
                <h3>ğŸ“Š AnÃ¡lisis Mensual</h3>
                <p>Resumen detallado de ingresos y gastos del mes</p>
                <button class="btn btn-secondary">Ver Reporte</button>
              </div>
              
              <div class="report-card">
                <h3>ğŸ“ˆ Tendencias</h3>
                <p>AnÃ¡lisis de patrones de gasto a lo largo del tiempo</p>
                <button class="btn btn-secondary">Ver Tendencias</button>
              </div>
              
              <div class="report-card">
                <h3>ğŸ¯ Progreso de Objetivos</h3>
                <p>Estado actual de tus metas de ahorro</p>
                <button class="btn btn-secondary">Ver Progreso</button>
              </div>
              
              <div class="report-card">
                <h3>ğŸ¤– Reporte IA</h3>
                <p>AnÃ¡lisis inteligente personalizado de tus finanzas</p>
                <button class="btn btn-secondary" onclick="window.app.showGenerateAiReportModal()">Generar</button>
              </div>
            </div>
          </div>
        </section>

        <!-- Settings Section -->
        <section id="settings-section" class="dashboard-section">
          <nav class="breadcrumb-nav">
            <a href="#" class="breadcrumb-item" data-section="dashboard">ğŸ“Š Resumen</a>
            <span class="breadcrumb-separator">â€º</span>
            <span class="breadcrumb-item active">âš™ï¸ ConfiguraciÃ³n</span>
          </nav>
          
          <div class="section-content">
            <div class="section-header">
              <h1>ConfiguraciÃ³n</h1>
            </div>
            
            <!-- Settings Categories -->
            <div class="settings-categories">
              <div class="settings-category">
                <h3>ğŸ‘¤ Cuenta y Perfil</h3>
                <div class="settings-grid">
                  <div class="settings-card">
                    <h4>InformaciÃ³n Personal</h4>
                    <p>Actualiza tu informaciÃ³n de perfil</p>
                    <button id="edit-profile-btn" class="btn btn-secondary btn-sm">Editar Perfil</button>
                  </div>
                  
                  <div class="settings-card">
                    <h4>Seguridad</h4>
                    <p>Cambiar contraseÃ±a y configuraciÃ³n de seguridad</p>
                    <button class="btn btn-secondary btn-sm">Configurar</button>
                  </div>
                </div>
              </div>
              
              <div class="settings-category">
                <h3>ğŸ·ï¸ PersonalizaciÃ³n</h3>
                <div class="settings-grid">
                  <div class="settings-card">
                    <h4>CategorÃ­as</h4>
                    <p>Gestiona tus categorÃ­as de gastos</p>
                    <button id="manage-categories-btn" class="btn btn-secondary btn-sm">
                      <span>ğŸ·ï¸</span>
                      Gestionar
                    </button>
                  </div>
                  
                  <div class="settings-card">
                    <h4>Tema y Apariencia</h4>
                    <p>Personaliza la apariencia de la aplicaciÃ³n</p>
                    <button class="btn btn-secondary btn-sm">Personalizar</button>
                  </div>
                </div>
              </div>
              
              <div class="settings-category">
                <h3>ğŸ“Š Datos y Respaldo</h3>
                <div class="settings-grid">
                  <div class="settings-card">
                    <h4>Exportar Datos</h4>
                    <p>Descarga tus datos financieros</p>
                    <button id="export-data-btn" class="btn btn-secondary btn-sm">
                      <span>ğŸ“Š</span>
                      Exportar
                    </button>
                  </div>
                  
                  <div class="settings-card">
                    <h4>Importar Datos</h4>
                    <p>Carga tus datos desde archivo CSV</p>
                    <button id="import-data-btn" class="btn btn-secondary btn-sm">
                      <span>ğŸ“¥</span>
                      Importar
                    </button>
                  </div>
                  
                  <div class="settings-card">
                    <h4>Respaldo de Datos</h4>
                    <p>Respalda y restaura tu informaciÃ³n</p>
                    <button id="backup-data-btn" class="btn btn-secondary btn-sm">
                      <span>â˜ï¸</span>
                      Respaldar
                    </button>
                  </div>
              </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Budgets Section -->
        <section id="budgets-section" class="dashboard-section">
          <nav class="breadcrumb-nav">
            <a href="#" class="breadcrumb-item" data-section="dashboard">ğŸ“Š Resumen</a>
            <span class="breadcrumb-separator">â€º</span>
            <span class="breadcrumb-item active">ğŸ’° Presupuestos</span>
          </nav>
          
          <div class="section-content">
            <div class="section-header">
              <h1>GestiÃ³n de Presupuestos</h1>
              <div class="section-actions">
                <button id="add-budget-btn" class="btn btn-primary">
                  <span>â•</span>
                  Nuevo Presupuesto
                </button>
                <button id="generate-budget-insights-btn" class="btn btn-secondary">
                  <span>ğŸ¤–</span>
                  AnÃ¡lisis IA
                </button>
              </div>
            </div>
            
            <!-- Budget AI Insights Section -->
            <div id="budget-ai-insights" class="budget-ai-insights">
              <!-- AI insights will be loaded here -->
            </div>
            
            <!-- ML Predictions Section -->
            <div id="ml-predictions-container" class="ml-predictions-container hidden">
              <!-- ML predictions will be loaded here -->
            </div>
            
            <!-- Spending Patterns Section -->
            <div id="spending-patterns-container" class="spending-patterns-container hidden">
              <!-- Spending patterns will be loaded here -->
            </div>
            
            <!-- Budgets List -->
            <div class="budgets-container">
              <div class="budgets-header">
                <h3>ğŸ“Š Presupuestos Activos</h3>
                <div class="budgets-summary">
                  <span id="total-budgets-count">0</span> presupuestos configurados
                </div>
              </div>
              
              <div id="budgets-list" class="budgets-list">
                <!-- Budgets will be loaded here -->
              </div>
            </div>
          </div>
        </section>
        <!-- Calendar Section (New) -->
        <section id="calendar-section" class="dashboard-section">
          <nav class="breadcrumb-nav">
            <a href="#" class="breadcrumb-item" data-section="dashboard">ğŸ“Š Resumen</a>
            <span class="breadcrumb-separator">â€º</span>
            <span class="breadcrumb-item active">ğŸ“… Calendario</span>
          </nav>
          
          <div class="section-content">
            <div class="section-header">
              <h1>Calendario Financiero</h1>
              <div class="section-actions">
                <button id="add-event-btn" class="btn btn-primary">
                  <span>â•</span>
                  Nuevo Evento
                </button>
                <button id="sync-google-calendar-btn" class="btn btn-secondary">
                  <span>ğŸ”„</span>
                  Sincronizar Google
                </button>
              </div>
            </div>
            
            <div class="calendar-container" style="margin-top: 0;">
              <!-- Calendar Navigation -->
              <div class="calendar-nav">
                <button id="prev-month" class="calendar-nav-btn">â€¹</button>
                <h3 id="current-month-year">Enero 2025</h3>
                <button id="next-month" class="calendar-nav-btn">â€º</button>
                <div class="calendar-view-toggle">
                  <button class="view-btn active" data-view="month">Mes</button>
                  <button class="view-btn" data-view="week">Semana</button>
                  <button class="view-btn" data-view="agenda">Agenda</button>
                </div>
              </div>
              
              <!-- Calendar Grid -->
              <div class="calendar-grid" id="calendar-grid">
                <!-- Calendar will be generated here -->
              </div>
              
              <!-- Events List (Agenda View) -->
              <div class="calendar-agenda hidden" id="calendar-agenda">
                <div class="agenda-events" id="agenda-events">
                  <!-- Events will be loaded here -->
                </div>
              </div>
            </div>
            
            <!-- Event Types Legend -->
            <div class="event-legend">
              <h4>Tipos de Eventos</h4>
              <div class="legend-items">
                <div class="legend-item">
                  <div class="legend-color payment"></div>
                  <span>Pagos de Cuotas</span>
                </div>
                <div class="legend-item">
                  <div class="legend-color income"></div>
                  <span>Cobros</span>
                </div>
                <div class="legend-item">
                  <div class="legend-color card-close"></div>
                  <span>Cierre de Tarjetas</span>
                </div>
                <div class="legend-item">
                  <div class="legend-color reminder"></div>
                  <span>Recordatorios</span>
                </div>
                <div class="legend-item">
                  <div class="legend-color deadline"></div>
                  <span>Vencimientos</span>
                </div>
              </div>
            </div>
          </div>
        </section>
    </main>
  </div>

  <!-- Mobile Navigation -->
  <nav class="mobile-nav" style="display: none;">
    <a href="#" class="mobile-nav-item" data-section="dashboard">
      <div class="mobile-nav-icon">ğŸ“Š</div>
      <div class="mobile-nav-label">Inicio</div>
    </a>
    <a href="#" class="mobile-nav-item" data-section="transactions">
      <div class="mobile-nav-icon">ğŸ’³</div>
      <div class="mobile-nav-label">Gastos</div>
    </a>
    <a href="#" class="mobile-nav-item" data-section="budgets">
      <div class="mobile-nav-icon">ğŸ’°</div>
      <div class="mobile-nav-label">Presupuestos</div>
    </a>
    <a href="#" class="mobile-nav-item" data-section="goals">
      <div class="mobile-nav-icon">ğŸ¯</div>
      <div class="mobile-nav-label">Objetivos</div>
    </a>
    <a href="#" class="mobile-nav-item" data-section="reports">
      <div class="mobile-nav-icon">ğŸ“ˆ</div>
      <div class="mobile-nav-label">Reportes</div>
    </a>
  </nav>

  <!-- Modals -->
  
  <!-- View Incomes Modal -->
  <div id="view-incomes-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>ğŸ’° Ingresos del Mes</h2>
        <button class="modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <div id="all-incomes-list" class="all-incomes-list">
          <!-- Lista de todos los ingresos del mes -->
        </div>
      </div>
      <div class="modal-actions">
        <button type="button" class="btn btn-secondary modal-cancel">Cerrar</button>
      </div>
    </div>
  </div>

  <!-- View Installments Modal -->
  <div id="view-installments-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>ğŸ“Š Cuotas Activas del Mes</h2>
        <button class="modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <div id="installments-list" class="installments-list">
          <!-- Lista de cuotas del mes -->
        </div>
      </div>
      <div class="modal-actions">
        <button type="button" class="btn btn-secondary modal-cancel">Cerrar</button>
      </div>
    </div>
  </div>

  <!-- Add Spending Limit Modal -->
  <div id="add-spending-limit-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Agregar LÃ­mite de Gasto</h2>
        <button class="modal-close">&times;</button>
      </div>
      <form id="add-spending-limit-form" class="modal-form">
        <div class="form-group">
          <label for="limit-category">CategorÃ­a</label>
          <select id="limit-category" name="category" required>
            <option value="">Selecciona una categorÃ­a</option>
          </select>
        </div>
        <div class="form-group">
          <label for="limit-amount">LÃ­mite Mensual</label>
          <input type="number" id="limit-amount" name="amount" step="0.01" required />
        </div>
        <div class="form-group">
          <label for="limit-warning">Porcentaje de Alerta (%)</label>
          <input type="number" id="limit-warning" name="warningPercentage" min="50" max="100" value="80" />
          <small class="input-hint">Te alertaremos cuando alcances este porcentaje del lÃ­mite</small>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn btn-secondary modal-cancel">Cancelar</button>
          <button type="submit" class="btn btn-primary">Crear LÃ­mite</button>
        </div>
      </form>
    </div>
  </div>
  
  <!-- Add Expense Modal -->
  <div id="add-expense-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Agregar Gasto</h2>
        <button class="modal-close">&times;</button>
      </div>
      <form id="add-expense-form" class="modal-form">
        <div class="form-group">
          <label for="expense-description">DescripciÃ³n</label>
          <input type="text" id="expense-description" name="description" required />
        </div>
        <div class="form-group">
          <label for="expense-amount">Monto</label>
          <input type="number" id="expense-amount" name="amount" step="0.01" required />
        </div>
        <div class="form-group">
          <label for="expense-category">CategorÃ­a</label>
          <select id="expense-category" name="category" required>
            <option value="">Selecciona una categorÃ­a</option>
          </select>
        </div>
        <div class="form-group">
          <label for="expense-date">Fecha</label>
          <input type="date" id="expense-date" name="transactionDate" required />
        </div>
        <div class="form-group">
          <label>
            <input type="checkbox" id="expense-installments" name="hasInstallments" />
            Pagar en cuotas
          </label>
        </div>
        <div id="installments-group" class="form-group hidden">
          <label for="expense-installments-count">NÃºmero de cuotas</label>
          <input type="number" id="expense-installments-count" name="installmentsCount" min="2" max="24" />
        </div>
        <div class="modal-actions">
          <button type="button" class="btn btn-secondary modal-cancel">Cancelar</button>
          <button type="submit" class="btn btn-primary">Agregar Gasto</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Add Income Modal -->
  <div id="add-income-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Agregar Ingreso</h2>
        <button class="modal-close">&times;</button>
      </div>
      <form id="add-income-form" class="modal-form">
        <div class="form-group">
          <label for="income-type">Tipo de Ingreso</label>
          <select id="income-type" name="type" required>
            <option value="fixed">Ingreso Fijo (Sueldo)</option>
            <option value="extra">Ingreso Extra</option>
          </select>
        </div>
        <div class="form-group">
          <label for="income-amount">Monto</label>
          <input type="number" id="income-amount" name="amount" step="0.01" required />
        </div>
        <div id="extra-income-group" class="hidden">
          <div class="form-group">
            <label for="income-description">DescripciÃ³n</label>
            <input type="text" id="income-description" name="description" />
          </div>
          <div class="form-group">
            <label for="income-category">CategorÃ­a</label>
            <select id="income-category" name="category">
              <option value="freelance">Freelance</option>
              <option value="bonus">Bonus</option>
              <option value="investment">InversiÃ³n</option>
              <option value="other">Otro</option>
            </select>
          </div>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn btn-secondary modal-cancel">Cancelar</button>
          <button type="submit" class="btn btn-primary">Agregar Ingreso</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Add Goal Modal -->
  <div id="add-goal-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Nuevo Objetivo de Ahorro</h2>
        <button class="modal-close">&times;</button>
      </div>
      <form id="add-goal-form" class="modal-form">
        <div class="form-group">
          <label for="goal-name">Nombre del Objetivo</label>
          <input type="text" id="goal-name" name="name" required />
        </div>
        <div class="form-group">
          <label for="goal-target">Monto Objetivo</label>
          <input type="number" id="goal-target" name="targetAmount" step="0.01" required />
        </div>
        <div class="form-group">
          <label for="goal-current">Monto Actual (opcional)</label>
          <input type="number" id="goal-current" name="currentAmount" step="0.01" value="0" />
        </div>
        <div class="modal-actions">
          <button type="button" class="btn btn-secondary modal-cancel">Cancelar</button>
          <button type="submit" class="btn btn-primary">Crear Objetivo</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Edit Goal Modal -->
  <div id="edit-goal-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Editar Objetivo de Ahorro</h2>
        <button class="modal-close">&times;</button>
      </div>
      <form id="edit-goal-form" class="modal-form">
        <div class="form-group">
          <label for="edit-goal-name">Nombre del Objetivo</label>
          <input type="text" id="edit-goal-name" name="name" required />
        </div>
        <div class="form-group">
          <label for="edit-goal-target">Monto Objetivo</label>
          <input type="number" id="edit-goal-target" name="targetAmount" step="0.01" required />
        </div>
        <div class="form-group">
          <label for="edit-goal-current">Monto Actual</label>
          <input type="number" id="edit-goal-current" name="currentAmount" step="0.01" />
        </div>
        <div class="modal-actions">
          <button type="button" class="btn btn-secondary modal-cancel">Cancelar</button>
          <button type="submit" class="btn btn-primary">Guardar Cambios</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Add Money to Goal Modal -->
  <div id="add-money-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Agregar Dinero al Objetivo</h2>
        <button class="modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <div class="goal-info">
          <h3 id="add-money-goal-name">Objetivo</h3>
          <p id="add-money-goal-progress">Progreso actual</p>
          <p id="add-money-max-amount" class="text-muted">MÃ¡ximo disponible</p>
        </div>
        <form id="add-money-form" class="modal-form">
          <div class="form-group">
            <label for="add-money-amount">Monto a Agregar</label>
            <input type="number" id="add-money-amount" name="amount" step="0.01" min="0.01" required />
            <small class="input-hint">Ingresa el monto que quieres agregar a este objetivo</small>
          </div>
          <div class="modal-actions">
            <button type="button" class="btn btn-secondary modal-cancel">Cancelar</button>
            <button type="submit" class="btn btn-primary">Agregar Dinero</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Manage Categories Modal -->
  <div id="manage-categories-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>ğŸ·ï¸ Gestionar CategorÃ­as</h2>
        <button class="modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <div class="categories-management">
          <div class="add-category-section">
            <h3>Agregar Nueva CategorÃ­a</h3>
            <form id="add-category-form" class="category-form">
              <div class="form-group">
                <label for="category-name">Nombre</label>
                <input type="text" id="category-name" name="name" required />
                <span>â•</span>
                Agregar CategorÃ­a
              </button>
            </form>
          </div>
          
          <div class="categories-list-section">
            <h3>CategorÃ­as Existentes</h3>
            <div id="categories-management-list" class="categories-management-list">
              <!-- Categories will be loaded here -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
    <!-- Complete Profile Modal -->
    <div id="complete-profile-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Completa tu Perfil</h3>
          <p class="modal-subtitle">Para personalizar tu experiencia, necesitamos algunos datos adicionales</p>
        </div>
        <form id="complete-profile-form" class="modal-form">
          <div class="form-group">
            <label for="complete-first-name">Nombre *</label>
            <input type="text" id="complete-first-name" name="first_name" required>
          </div>
          <div class="form-group">
            <label for="complete-last-name">Apellido *</label>
            <input type="text" id="complete-last-name" name="last_name" required>
          </div>
          <div class="modal-actions">
            <button type="submit" class="btn btn-primary">
              <span>âœ…</span> Completar Perfil
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Edit Profile Modal -->
    <div id="edit-profile-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Editar Perfil</h3>
          <button class="modal-close">&times;</button>
        </div>
        <form id="edit-profile-form" class="modal-form">
          <div class="form-group">
            <label for="edit-first-name">Nombre *</label>
            <input type="text" id="edit-first-name" name="first_name" required>
          </div>
          <div class="form-group">
            <label for="edit-last-name">Apellido *</label>
            <input type="text" id="edit-last-name" name="last_name" required>
          </div>
          <div class="modal-actions">
            <button type="button" class="btn btn-secondary modal-cancel">Cancelar</button>
            <button type="submit" class="btn btn-primary">
              <span>ğŸ’¾</span> Guardar Cambios
            </button>
          </div>
        </form>
      </div>
    </div>

  <!-- Import Data Modal -->
  <div id="import-data-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>ğŸ“¥ Importar Datos</h2>
        <button class="modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <div class="import-section">
          <h3>Seleccionar Archivo CSV</h3>
          <div class="file-upload-area">
            <input type="file" id="import-file" accept=".csv" />
            <div class="file-upload-info">
              <p><strong>Formatos soportados automÃ¡ticamente:</strong></p>
              <ul>
                <li><strong>FINZN Completo:</strong> tipo,descripcion,monto,categoria,fecha,mes,cuota_actual,total_cuotas,monto_original,es_recurrente</li>
                <li><strong>Gastos:</strong> descripcion,monto,categoria,fecha,cuota_actual,total_cuotas</li>
                <li><strong>Ingresos:</strong> tipo,monto,descripcion,fecha</li>
                <li><strong>Banco:</strong> fecha,descripcion,monto (detecta automÃ¡ticamente gastos/ingresos)</li>
                <li><strong>Otros formatos:</strong> Se detectan automÃ¡ticamente por contenido</li>
              </ul>
              <p><em>El sistema detecta automÃ¡ticamente el formato y tipo de datos.</em></p>
            </div>
          </div>
          <div class="import-options">
            <label>
              <input type="radio" name="import-type" value="auto" checked />
              DetecciÃ³n AutomÃ¡tica (Recomendado)
            </label>
            <label>
              <input type="radio" name="import-type" value="expenses" />
              Forzar como Gastos
            </label>
            <label>
              <input type="radio" name="import-type" value="incomes" />
              Forzar como Ingresos
            </label>
          </div>
        </div>
      </div>
      <div class="modal-actions">
        <button type="button" class="btn btn-secondary modal-cancel">Cancelar</button>
        <button type="button" id="process-import-btn" class="btn btn-primary">
          <span>ğŸ“¥</span>
          Importar Datos
        </button>
      </div>
    </div>
  </div>

  <!-- Generate AI Report Modal -->
  <div id="generate-ai-report-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>ğŸ¤– Generar Informe Financiero con IA</h2>
        <button class="modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <div class="ai-report-options">
          <div class="form-group">
            <label for="report-period">PerÃ­odo del Informe</label>
            <select id="report-period" name="period">
              <option value="current">Mes Actual</option>
              <option value="last3">Ãšltimos 3 Meses</option>
              <option value="last6">Ãšltimos 6 Meses</option>
              <option value="year">AÃ±o Completo</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="report-focus">Enfoque del Informe</label>
            <select id="report-focus" name="focus">
              <option value="general">AnÃ¡lisis General</option>
              <option value="savings">Enfoque en Ahorros</option>
              <option value="expenses">AnÃ¡lisis de Gastos</option>
              <option value="budget">OptimizaciÃ³n de Presupuesto</option>
              <option value="goals">Progreso hacia Objetivos</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="report-questions">Preguntas EspecÃ­ficas (Opcional)</label>
            <textarea id="report-questions" name="questions" rows="3" placeholder="Â¿Hay algo especÃ­fico que te gustarÃ­a saber sobre tus finanzas?"></textarea>
          </div>
        </div>
        
        <div id="ai-report-result" class="ai-report-result hidden">
          <h3>ğŸ“Š Tu Informe Financiero Personalizado</h3>
          <div id="ai-report-content" class="ai-report-content">
            <!-- El informe generado aparecerÃ¡ aquÃ­ -->
          </div>
          <div class="ai-report-actions">
            <button id="download-report-btn" class="btn btn-secondary">
              <span>ğŸ“„</span>
              Descargar
            </button>
            <button id="share-report-btn" class="btn btn-secondary">
              <span>ğŸ“¤</span>
              Compartir
            </button>
          </div>
        </div>
      </div>
      <div class="modal-actions">
        <button type="button" class="btn btn-secondary modal-cancel">Cancelar</button>
        <button type="button" id="generate-report-btn" class="btn btn-primary">
          <span>ğŸ¤–</span>
          Generar Informe
        </button>
      </div>
    </div>
  </div>

  <!-- Chat Widget -->
  <div id="chat-widget" class="chat-widget">
    <button id="chat-toggle" class="chat-toggle" title="Chat con asistente financiero">
      <img src="./robot-chat.png" alt="Chat" class="chat-toggle-icon" />
    </button>
    
    <div id="chat-window" class="chat-window hidden">
      <div class="chat-header">
        <div class="chat-header-info">
          <img src="./robot-chat.png" alt="Asistente" class="chat-header-avatar" />
          <div class="chat-header-text">
            <h3>Asistente FINZN</h3>
            <p>Tu consejero financiero</p>
          </div>
        </div>
        <button id="chat-close" class="chat-close">&times;</button>
      </div>
      
      <div id="chat-messages" class="chat-messages">
        <!-- Messages will be added here -->
      </div>
      
      <form id="chat-form" class="chat-form">
        <input type="text" id="chat-input" placeholder="Escribe tu pregunta..." autocomplete="off" />
        <button type="submit" class="chat-send">
          <span>ğŸ“¤</span>
        </button>
      </form>
    </div>
  </div>

  <!-- Add Calendar Event Modal -->
  <div id="add-event-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Agregar Evento Financiero</h2>
        <button class="modal-close">&times;</button>
      </div>
      <form id="add-event-form" class="modal-form">
        <div class="form-group">
          <label for="event-title">TÃ­tulo del Evento</label>
          <input type="text" id="event-title" name="title" required />
        </div>
        <div class="form-group">
          <label for="event-type">Tipo de Evento</label>
          <select id="event-type" name="type" required>
            <option value="">Selecciona un tipo</option>
            <option value="payment">ğŸ’³ Pago de Cuota</option>
            <option value="income">ğŸ’° Cobro</option>
            <option value="card-close">ğŸ¦ Cierre de Tarjeta</option>
            <option value="reminder">â° Recordatorio</option>
            <option value="deadline">ğŸ“… Vencimiento</option>
          </select>
        </div>
        <div class="form-group">
          <label for="event-date">Fecha</label>
          <input type="date" id="event-date" name="date" required />
        </div>
        <div class="form-group">
          <label for="event-time">Hora (opcional)</label>
          <input type="time" id="event-time" name="time" />
        </div>
        <div class="form-group">
          <label for="event-amount">Monto (opcional)</label>
          <input type="number" id="event-amount" name="amount" step="0.01" />
        </div>
        <div class="form-group">
          <label for="event-description">DescripciÃ³n</label>
          <textarea id="event-description" name="description" rows="3"></textarea>
        </div>
        <div class="form-group">
          <label>
            <input type="checkbox" id="event-recurring" name="recurring" />
            Evento recurrente
          </label>
        </div>
        <div id="recurring-options" class="form-group hidden">
          <label for="recurring-frequency">Frecuencia</label>
          <select id="recurring-frequency" name="frequency">
            <option value="weekly">Semanal</option>
            <option value="monthly">Mensual</option>
            <option value="yearly">Anual</option>
          </select>
        </div>
        <div class="form-group">
          <label>
            <input type="checkbox" id="event-notification" name="notification" checked />
            Recordatorio por notificaciÃ³n
          </label>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn btn-secondary modal-cancel">Cancelar</button>
          <button type="submit" class="btn btn-primary">Crear Evento</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Edit Calendar Event Modal -->
  <div id="edit-event-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Editar Evento</h2>
        <button class="modal-close">&times;</button>
      </div>
      <form id="edit-event-form" class="modal-form">
        <div class="form-group">
          <label for="edit-event-title">TÃ­tulo del Evento</label>
          <input type="text" id="edit-event-title" name="title" required />
        </div>
        <div class="form-group">
          <label for="edit-event-type">Tipo de Evento</label>
          <select id="edit-event-type" name="type" required>
            <option value="payment">ğŸ’³ Pago de Cuota</option>
            <option value="income">ğŸ’° Cobro</option>
            <option value="card-close">ğŸ¦ Cierre de Tarjeta</option>
            <option value="reminder">â° Recordatorio</option>
            <option value="deadline">ğŸ“… Vencimiento</option>
          </select>
        </div>
        <div class="form-group">
          <label for="edit-event-date">Fecha</label>
          <input type="date" id="edit-event-date" name="date" required />
        </div>
        <div class="form-group">
          <label for="edit-event-time">Hora</label>
          <input type="time" id="edit-event-time" name="time" />
        </div>
        <div class="form-group">
          <label for="edit-event-amount">Monto</label>
          <input type="number" id="edit-event-amount" name="amount" step="0.01" />
        </div>
        <div class="form-group">
          <label for="edit-event-description">DescripciÃ³n</label>
          <textarea id="edit-event-description" name="description" rows="3"></textarea>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn btn-secondary modal-cancel">Cancelar</button>
          <button type="submit" class="btn btn-primary">Guardar Cambios</button>
          <button type="button" id="delete-event-btn" class="btn btn-danger">Eliminar</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Event Details Modal -->
  <div id="event-details-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="event-details-title">Detalles del Evento</h2>
        <button class="modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <div id="event-details-content">
          <!-- Event details will be loaded here -->
        </div>
      </div>
      <div class="modal-actions">
        <button type="button" class="btn btn-secondary modal-cancel">Cerrar</button>
        <button type="button" id="edit-event-from-details" class="btn btn-primary">Editar</button>
      </div>
    </div>
  </div>

  <!-- Add Budget Modal -->
  <div id="add-budget-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Crear Nuevo Presupuesto</h2>
        <button class="modal-close">&times;</button>
      </div>
      <form id="add-budget-form" class="modal-form">
        <div class="form-group">
          <label for="budget-name">Nombre del Presupuesto</label>
          <input type="text" id="budget-name" name="name" required placeholder="Ej: Presupuesto Mensual Comida" />
        </div>
        <div class="form-group">
          <label for="budget-category">CategorÃ­a</label>
          <select id="budget-category" name="category" required>
            <option value="">Selecciona una categorÃ­a</option>
          </select>
        </div>
        <div class="form-group">
          <label for="budget-amount">Monto LÃ­mite</label>
          <input type="number" id="budget-amount" name="amount" step="0.01" required placeholder="0.00" />
          <small class="input-hint">Monto mÃ¡ximo que planeas gastar en esta categorÃ­a</small>
        </div>
        <div class="form-group">
          <label for="budget-start-date">Fecha de Inicio</label>
          <input type="date" id="budget-start-date" name="start_date" required />
        </div>
        <div class="form-group">
          <label for="budget-end-date">Fecha de FinalizaciÃ³n</label>
          <input type="date" id="budget-end-date" name="end_date" required />
        </div>
        <div class="form-group">
          <label>
            <input type="checkbox" id="budget-ai-recommendations" name="ai_recommended" />
            Permitir recomendaciones de IA para este presupuesto
          </label>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn btn-secondary modal-cancel">Cancelar</button>
          <button type="submit" class="btn btn-primary">Crear Presupuesto</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Edit Budget Modal -->
  <div id="edit-budget-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Editar Presupuesto</h2>
        <button class="modal-close">&times;</button>
      </div>
      <form id="edit-budget-form" class="modal-form">
        <div class="form-group">
          <label for="edit-budget-name">Nombre del Presupuesto</label>
          <input type="text" id="edit-budget-name" name="name" required />
        </div>
        <div class="form-group">
          <label for="edit-budget-category">CategorÃ­a</label>
          <select id="edit-budget-category" name="category" required>
            <option value="">Selecciona una categorÃ­a</option>
          </select>
        </div>
        <div class="form-group">
          <label for="edit-budget-amount">Monto LÃ­mite</label>
          <input type="number" id="edit-budget-amount" name="amount" step="0.01" required />
        </div>
        <div class="form-group">
          <label for="edit-budget-start-date">Fecha de Inicio</label>
          <input type="date" id="edit-budget-start-date" name="start_date" required />
        </div>
        <div class="form-group">
          <label for="edit-budget-end-date">Fecha de FinalizaciÃ³n</label>
          <input type="date" id="edit-budget-end-date" name="end_date" required />
        </div>
        <div class="form-group">
          <label>
            <input type="checkbox" id="edit-budget-ai-recommendations" name="ai_recommended" />
            Permitir recomendaciones de IA para este presupuesto
          </label>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn btn-secondary modal-cancel">Cancelar</button>
          <button type="submit" class="btn btn-primary">Guardar Cambios</button>
          <button type="button" id="delete-budget-btn" class="btn btn-danger">Eliminar</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Budget AI Insights Modal -->
  <div id="budget-ai-insights-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>ğŸ¤– AnÃ¡lisis IA de Presupuestos</h2>
        <button class="modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <div id="budget-ai-analysis-content" class="budget-ai-analysis-content">
          <!-- AI analysis will be loaded here -->
        </div>
      </div>
      <div class="modal-actions">
        <button type="button" class="btn btn-secondary modal-cancel">Cerrar</button>
        <button type="button" id="apply-ai-recommendations-btn" class="btn btn-primary">
          <span>âœ¨</span>
          Aplicar Recomendaciones
        </button>
      </div>
    </div>
  </div>

  <!-- Load main application -->
</body>
</html>