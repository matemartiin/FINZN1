<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>FINZN - Tu Compañero Financiero Inteligente</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/vendor/phosphor/regular/style.css">
  <link rel="stylesheet" href="/vendor/phosphor/bold/style.css">
  <link rel="stylesheet" href="/vendor/phosphor/light/style.css">
  <link rel="stylesheet" href="/vendor/phosphor/thin/style.css">
  <link rel="stylesheet" href="/vendor/phosphor/fill/style.css">
  <link rel="stylesheet" href="/vendor/phosphor/duotone/style.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.js"></script>
  <link rel="stylesheet" href="./src/styles/main.css">
  <link rel="stylesheet" href="./src/styles/loading.css">
  <link rel="stylesheet" href="./src/styles/skin-pro.css">
  <link rel="stylesheet" href="./src/styles/consolidated-fixes.css">
  <link rel="stylesheet" href="./src/styles/unified-dashboard.css">
  <link rel="stylesheet" href="./src/styles/new-dashboard.css">
  <link rel="stylesheet" href="./src/styles/dashboard-second-row.css">
  <link rel="stylesheet" href="./src/styles/responsive-fix.css">
  <link rel="stylesheet" href="./src/styles/delete-all-events.css">
  <link rel="stylesheet" href="./src/styles/income-buttons.css">
  <!-- Color override must be last to take precedence -->
  <link rel="stylesheet" href="./src/styles/dashboard-numbers-color.css">
</head>
<body data-layout="v2" data-skin="pro">
  <!-- Alert System -->
  <div id="alert-container" class="alert-container"></div>
  
  <!-- Login Container -->
  <div id="login-container" class="auth-container">
    <div class="auth-card">
      <div class="auth-header">
        <div class="auth-logo">
          <div class="finzn-logo-main">
            <img src="isotipo.png" alt="FINZN Mascot" width="120" height="120" style="border-radius: 50%; box-shadow: 0 8px 32px rgba(183, 166, 255, 0.3);" />
          </div>
          <h1 class="auth-title">FINZN</h1>
        </div>
        <p class="auth-subtitle">Tu compañero financiero inteligente</p>
        <p class="auth-description">Gestiona tus finanzas de manera simple y divertida</p>
      </div>
      
      <form id="login-form" class="auth-form">
        <div class="input-group">
          <label for="login-user" class="sr-only">Email</label>
          <input type="email" id="login-user" name="username" placeholder="Email" required autocomplete="email" aria-label="Email" />
        </div>
        <div class="input-group">
          <label for="login-pass" class="sr-only">Contraseña</label>
          <input type="password" id="login-pass" name="password" placeholder="Contraseña" required autocomplete="current-password" aria-label="Contraseña" />
        </div>
        <button type="submit" class="btn btn-primary btn-full">
          <i class="ph ph-sparkle" aria-hidden="true"></i>
          Iniciar Sesión
        </button>
        <div id="login-error" class="error-message"></div>
      </form>
      
      <div class="auth-footer">
        <p>¿No tienes cuenta? <button type="button" id="show-register" class="link-btn">Regístrate aquí</button></p>
      </div>
    </div>
  </div>

  <!-- Register Container -->
  <div id="register-container" class="auth-container hidden">
    <div class="auth-card">
      <div class="auth-header">
        <div class="auth-logo">
          <div class="finzn-logo-main">
            <img src="/ChatGPT Image Jul 2, 2025, 10_45_30 PM.png" alt="FINZN Mascot" width="120" height="120" style="border-radius: 50%; box-shadow: 0 8px 32px rgba(183, 166, 255, 0.3);" />
          </div>
          <h1 class="auth-title">¡Bienvenido!</h1>
        </div>
        <p class="auth-subtitle">Únete a FINZN</p>
        <p class="auth-description">Comienza tu viaje hacia la libertad financiera</p>
      </div>
      
      <form id="register-form" class="auth-form">
        <div class="input-group">
          <label for="register-user" class="sr-only">Email</label>
          <input type="email" id="register-user" name="username" placeholder="Email" required autocomplete="email" aria-label="Email" aria-describedby="email-hint" />
          <small id="email-hint" class="input-hint">Usa un email único, por ejemplo: tu.nombre@gmail.com</small>
        </div>
        <div class="input-group">
          <label for="register-pass" class="sr-only">Contraseña</label>
          <input type="password" id="register-pass" name="password" placeholder="Contraseña" required autocomplete="new-password" aria-label="Contraseña" aria-describedby="password-hint" />
          <small id="password-hint" class="input-hint">Mínimo 6 caracteres</small>
        </div>
        <div class="input-group">
          <button type="button" id="generate-test-email" class="btn btn-secondary btn-sm">
            <i class="ph ph-dice-six" aria-hidden="true"></i> Generar email de prueba
          </button>
        </div>
        <button type="submit" class="btn btn-primary btn-full">
          <i class="ph ph-rocket-launch" aria-hidden="true"></i>
          Crear Cuenta
        </button>
        <div id="register-error" class="error-message"></div>
      </form>
      
      <div class="auth-footer">
        <p>¿Ya tienes cuenta? <button type="button" id="show-login" class="link-btn">Inicia sesión</button></p>
      </div>
    </div>
  </div>
  
  <!-- Main Application -->
  <div id="app" class="app hidden">
    <!-- Header -->
    <header class="header">
  <div class="header-content">
    <!-- IZQUIERDA: logo -->
    <div class="header-left">
      <div class="logo-container">
        <div class="finzn-logo-header">
          <img src="/isotipo.png" alt="FINZN Logo" class="logo-icon" />
        </div>
        <h1 class="logo">FINZN</h1>
      </div>
    </div>

    <!-- DERECHA: usuario + tema + salir (desktop) -->
    <div class="header-right">
      <div class="user-info">
        <span id="user-name"></span>
      </div>

      <!-- Botón tema (desktop) -->
      <button id="theme-toggle" class="btn btn-icon theme-toggle" title="Cambiar tema" aria-label="Cambiar tema">
  <i class="ph ph-moon-stars" aria-hidden="true"></i>
</button>


      <!-- Salir (desktop) -->
      <button id="logout-btn" class="btn btn-secondary logout-btn" title="Cerrar sesión">
  <i class="ph ph-sign-out" aria-hidden="true"></i>
  <span class="logout-text">Salir</span>
</button>

      <!-- Hamburguesa (solo mobile) -->
      <button id="header-menu-toggle" class="hamburger" aria-label="Abrir menú">
        <span></span><span></span><span></span>
      </button>

      <!-- Menú móvil -->
      <div id="header-menu" class="header-menu">
        <div class="header-menu-header">
          <div class="menu-user">
            <div class="menu-user-avatar"><i class="ph ph-user"></i></div>
            <div class="menu-user-name" id="menu-user-name">Usuario</div>
          </div>
          <button id="header-menu-close" class="menu-close" aria-label="Cerrar">
            <i class="ph ph-x" aria-hidden="true"></i>
          </button>
        </div>

        <nav class="header-menu-items">
          <button class="menu-item" id="header-menu-settings">
            <i class="ph ph-gear-six" aria-hidden="true"></i> Configuración
          </button>

          <label class="menu-item switch">
            <input type="checkbox" id="header-theme-switch" />
            <span class="slider"></span>
            <span class="switch-label">Modo oscuro</span>
          </label>

          <button class="menu-item danger" id="header-menu-logout">
            <i class="ph ph-sign-out" aria-hidden="true"></i> Salir
          </button>
        </nav>
      </div>
    </div>
  </div>
</header>


    <!-- Dashboard with New Layout -->
    <main id="layout-root" class="dashboard-new" role="main">
      <!-- Sidebar Navigation -->
      <aside class="sidebar-nav" role="navigation" aria-label="Secciones">
        <nav class="nav-menu">
          <!-- Primary Navigation -->
          <div class="nav-group primary-nav">
            <div class="nav-item active" data-section="dashboard">
  <div class="nav-icon icon"><i class="ph ph-chart-pie" aria-hidden="true"></i></div>
  <span class="nav-label">Resumen</span>
</div>

            <div class="nav-item" data-section="transactions">
  <div class="nav-icon icon"><i class="ph ph-credit-card" aria-hidden="true"></i></div>
  <span class="nav-label">Transacciones</span>
  <div class="nav-badge" id="pending-transactions">0</div>
</div>
            <div class="nav-item" data-section="goals">
  <div class="nav-icon icon"><i class="ph ph-target" aria-hidden="true"></i></div>
  <span class="nav-label">Objetivos</span>
</div>
            <div class="nav-item" data-section="calendar">
  <div class="nav-icon icon"><i class="ph ph-calendar-blank" aria-hidden="true"></i></div>
  <span class="nav-label">Calendario</span>
  <div class="nav-badge" id="upcoming-events">0</div>
</div>
            <div class="nav-item" data-section="budgets">
  <div class="nav-icon icon"><i class="ph ph-wallet" aria-hidden="true"></i></div>
  <span class="nav-label">Presupuestos</span>
  <div class="nav-badge" id="active-budgets">0</div>
</div>
          </div>
          
          <!-- Secondary Navigation -->
          <div class="nav-divider"></div>
          <div class="nav-group secondary-nav">
            <div class="nav-item" data-section="reports">
  <div class="nav-icon icon"><i class="ph ph-chart-line-up"></i></div>
  <span class="nav-label">Reportes</span>
</div>
            <div class="nav-item" data-section="settings">
  <div class="nav-icon icon"><i class="ph ph-gear-six"></i></div>
  <span class="nav-label">Configuración</span>
</div>
          </div>
          
          <!-- Mobile Menu Toggle -->
          <button class="mobile-menu-toggle" id="mobile-menu-toggle">
  <div class="nav-icon icon"><i class="ph ph-list" aria-hidden="true"></i></div>
  <span class="nav-label">Menú</span>
</button>
        </nav>
        
      </aside>

      <!-- Main Content Area -->
      <div class="main-dashboard">
        <!-- Dashboard Section -->
        <section id="dashboard-section" class="dashboard-section active">
          <div class="dashboard-grid">
            <!-- New Unified Balance Card -->
            <div class="new-unified-card">
              <!-- Balance Section (Left) -->
              <div class="new-balance-section">
                <div class="new-balance-header">
                  <div class="new-balance-icon">
                    <i class="ph ph-wallet"></i>
                  </div>
                  <span class="new-balance-title">Balance Total</span>
                </div>
                <div class="new-balance-amount" id="balance-amount-new">$2,750</div>
                <div class="new-balance-subtitle">
                  <button id="installments-btn" class="new-installments-button">
                    <span id="installments-count">0</span> cuotas activas
                  </button>
                </div>
              </div>
              
              <!-- Income & Expenses Section (Right) -->
              <div class="new-income-expenses-section">
                <!-- Income -->
                <div class="new-income-item">
                  <div class="new-item-header">
                    <div class="new-item-icon new-income-icon">
                      <i class="ph ph-trend-up"></i>
                    </div>
                    <span class="new-item-title">Ingresos</span>
                    <button id="incomes-indicator" class="new-incomes-indicator" title="Ver historial de ingresos del mes">
                      <span class="indicator-count">0</span>
                    </button>
                  </div>
                  <div class="new-item-amount-row">
                    <span class="new-item-amount" id="income-summary">$3,500</span>
                    <button id="add-income-btn-dashboard" class="new-action-btn new-income-action" title="Agregar Ingreso">
                      <i class="ph ph-plus"></i>
                    </button>
                  </div>
                </div>
                
                <!-- Expenses -->
                <div class="new-expense-item">
                  <div class="new-item-header">
                    <div class="new-item-icon new-expense-icon">
                      <i class="ph ph-trend-down"></i>
                    </div>
                    <span class="new-item-title">Gastos</span>
                  </div>
                  <div class="new-item-amount-row">
                    <span class="new-item-amount" id="monthly-expenses-summary">$1,200</span>
                    <button id="add-expense-btn-dashboard" class="new-action-btn new-expense-action" title="Agregar Gasto">
                      <i class="ph ph-minus"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Dashboard Second Row -->
            <div class="dashboard-second-row">
              <!-- Chart Section -->
              <div class="chart-card">
                <div class="chart-header">
                  <h3>Distribución de Gastos</h3>
                  <span class="chart-subtitle">Por categoría</span>
                </div>
                <div class="chart-container">
                  <canvas id="dashboard-expenses-chart"></canvas>
                </div>
              </div>

              <!-- Recent Transactions Card -->
              <div class="recent-transactions-card">
                <div class="card-header">
                  <h3>Movimientos Recientes</h3>
                  <button class="view-all-btn" data-section="transactions">
                    <span>Ver todos</span>
                    <i class="ph ph-arrow-right"></i>
                  </button>
                </div>
                <div class="recent-transactions-list" id="recent-transactions-list">
                  <!-- Se llenarán con JavaScript -->
                </div>
              </div>
            </div>

        </section>

        <!-- Transactions Section (Renamed from Expenses) -->
        <section id="transactions-section" class="dashboard-section">
          
          <div class="section-content">
            <div class="section-header">
              <h1>Gestión de Transacciones</h1>
              <div class="section-actions">
                <button id="add-expense-btn-transactions" class="btn btn-primary">
  <i class="ph ph-plus" aria-hidden="true"></i> Nuevo Gasto
</button>
                <button id="add-income-btn-transactions" class="btn btn-secondary">
  <i class="ph ph-plus-circle" aria-hidden="true"></i> Nuevo Ingreso
</button>
              </div>
            </div>
            
            <!-- Transaction Tabs -->
            <div class="transaction-tabs">
              <button class="tab-btn active" data-tab="expenses">Gastos</button>
              <button class="tab-btn" data-tab="income">Ingresos</button>
              <button class="tab-btn" data-tab="limits">Límites</button>
            </div>
            
            <div class="transactions-container">
              <div class="tab-content active" id="expenses-tab">
                <div class="expenses-section-card">
                  <div class="card-header">
                    <h3><i class="ph ph-credit-card" aria-hidden="true"></i> Gastos del Mes</h3>
                  </div>
                  <div id="expenses-list" class="expenses-list">
                    <!-- Expenses will be loaded here -->
                  </div>
                </div>
              </div>
              
              <div class="tab-content" id="income-tab">
                <div class="income-section-card">
                  <div class="card-header">
                    <h3><i class="ph ph-money" aria-hidden="true"></i> Ingresos del Mes</h3>
                  </div>
                  <div id="income-list" class="income-list">
                    <!-- Income will be loaded here -->
                  </div>
                </div>
              </div>
              
              <div class="tab-content" id="limits-tab">
                <div class="expenses-section-card spending-limits-main-card">
                  <div class="card-header">
                    <h3><i class="ph ph-traffic-sign" aria-hidden="true"></i> Límites Presupuestarios</h3>
                    <button id="add-spending-limit-btn-transactions" class="btn btn-primary btn-sm">
                      <i class="ph ph-plus" aria-hidden="true"></i>
                      Nuevo Límite
                    </button>
                  </div>
                  <div id="category-limits-display" class="category-limits-display">
                    <!-- Spending limits will be loaded here -->
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>


        <!-- Goals Section (Renamed from Savings) -->
        <section id="goals-section" class="dashboard-section">
          
          <div class="section-content">
            <div class="section-header">
              <h1>Objetivos de Ahorro</h1>
              <div class="section-actions">
                <button id="add-goal-btn" class="btn btn-primary">
                  <i class="ph ph-target" aria-hidden="true"></i>
                  Nuevo Objetivo
                </button>
              </div>
            </div>
            
            <div id="goals-list" class="goals-list">
              <!-- Goals will be loaded here -->
            </div>
          </div>
        </section>

        <!-- Reports Section (Renamed from Achievements) -->
        <section id="reports-section" class="dashboard-section">
          
          <div class="section-content">
            <div class="section-header">
              <h1>Reportes y Análisis</h1>
              <div class="section-actions">
                <button id="generate-report-btn-section" class="btn btn-primary">
  <i class="ph ph-robot" aria-hidden="true"></i> Generar Reporte IA
</button>
              </div>
            </div>
            
            <div class="reports-grid">
              <div class="report-card">
                <h3><i class="ph ph-chart-bar" aria-hidden="true"></i> Análisis Mensual</h3>
                <p>Resumen detallado de ingresos y gastos del mes</p>
                <button class="btn btn-secondary">Ver Reporte</button>
              </div>
              
              <div class="report-card">
                <h3><i class="ph ph-trend-up" aria-hidden="true"></i> Tendencias</h3>
                <p>Análisis de patrones de gasto a lo largo del tiempo</p>
                <button class="btn btn-secondary">Ver Tendencias</button>
              </div>
              
              <div class="report-card">
                <h3><i class="ph ph-target" aria-hidden="true"></i> Progreso de Objetivos</h3>
                <p>Estado actual de tus metas de ahorro</p>
                <button class="btn btn-secondary">Ver Progreso</button>
              </div>
              
              <div class="report-card">
                <h3><i class="ph ph-robot" aria-hidden="true"></i> Reporte IA</h3>
                <p>Análisis inteligente personalizado de tus finanzas</p>
                <button id="reports-generate-ai-card-btn" class="btn btn-secondary">Generar</button>
              </div>
            </div>
          </div>
        </section>

        <!-- Settings Section -->
        <section id="settings-section" class="dashboard-section">
          
          <div class="section-content">
            <div class="section-header">
              <h1>Configuración</h1>
            </div>
            
            <!-- Settings Categories -->
            <div class="settings-categories">
              <div class="settings-category">
                <h3><i class="ph ph-user" aria-hidden="true"></i> Cuenta y Perfil</h3>
                <div class="settings-grid">
                  <div class="settings-card">
                    <h4>Información Personal</h4>
                    <p>Actualiza tu información de perfil</p>
                    <button id="edit-profile-btn" class="btn btn-secondary btn-sm">Editar Perfil</button>
                  </div>
                  
                  <div class="settings-card">
                    <h4>Seguridad</h4>
                    <p>Cambiar contraseña y configuración de seguridad</p>
                    <button class="btn btn-secondary btn-sm">Configurar</button>
                  </div>
                </div>
              </div>
              
              <div class="settings-category">
                <h3><i class="ph ph-tag" aria-hidden="true"></i> Personalización</h3>
                <div class="settings-grid">
                  <div class="settings-card">
                    <h4>Categorías</h4>
                    <p>Gestiona tus categorías de gastos</p>
                    <button id="manage-categories-btn" class="btn btn-secondary btn-sm">
  <i class="ph ph-tag" aria-hidden="true"></i> Gestionar
</button>
                  </div>
                  
                  <div class="settings-card">
                    <h4>Tema y Apariencia</h4>
                    <p>Personaliza la apariencia de la aplicación</p>
                    <button class="btn btn-secondary btn-sm">Personalizar</button>
                  </div>
                </div>
              </div>
              
              <div class="settings-category">
                <h3><i class="ph ph-database" aria-hidden="true"></i> Datos y Respaldo</h3>
                <div class="settings-grid">
                  <div class="settings-card">
                    <h4>Exportar Datos</h4>
                    <p>Descarga tus datos financieros</p>
                    <button id="export-data-btn" class="btn btn-secondary btn-sm">
  <i class="ph ph-download-simple" aria-hidden="true"></i> Exportar
</button>
                  </div>
                  
                  <div class="settings-card">
                    <h4>Importar Datos</h4>
                    <p>Carga tus datos desde archivo CSV</p>
                    <button id="import-data-btn" class="btn btn-secondary btn-sm">
  <i class="ph ph-upload-simple" aria-hidden="true"></i> Importar
</button>
                  </div>
                  
                  <div class="settings-card">
                    <h4>Respaldo de Datos</h4>
                    <p>Respalda y restaura tu información</p>
                    <button id="backup-data-btn" class="btn btn-secondary btn-sm">
  <i class="ph ph-cloud-arrow-up" aria-hidden="true"></i> Respaldar
</button>
                  </div>
              </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Budgets Section -->
        <section id="budgets-section" class="dashboard-section">
          
          <div class="section-content">
            <div class="section-header">
              <h1>Gestión de Presupuestos</h1>
              <div class="section-actions">
                <button id="add-budget-btn" class="btn btn-primary">
  <i class="ph ph-plus" aria-hidden="true"></i> Nuevo Presupuesto
</button>
                <button id="generate-budget-insights-btn" class="btn btn-secondary">
  <i class="ph ph-robot" aria-hidden="true"></i> Análisis IA
</button>
              </div>
            </div>
            
            <!-- Budget AI Insights Section -->
            <div id="budget-ai-insights" class="budget-ai-insights">
              <!-- AI insights will be loaded here -->
            </div>
            
            <!-- ML Predictions Section -->
            <div id="ml-predictions-container" class="ml-predictions-container hidden">
              <!-- ML predictions will be loaded here -->
            </div>
            
            <!-- Spending Patterns Section -->
            <div id="spending-patterns-container" class="spending-patterns-container hidden">
              <!-- Spending patterns will be loaded here -->
            </div>
            
            <!-- Budgets List -->
            <div class="budgets-container">
              <div class="budgets-header">
                <h3><i class="ph ph-chart-pie" aria-hidden="true"></i> Presupuestos Activos</h3>
                <div class="budgets-summary">
                  <span id="total-budgets-count">0</span> presupuestos configurados
                </div>
              </div>
              
              <div id="budgets-list" class="budgets-list">
                <!-- Budgets will be loaded here -->
              </div>
            </div>
          </div>
        </section>
        <!-- Calendar Section (New) -->
        <section id="calendar-section" class="dashboard-section">
          
          <div class="section-content">
            <div class="section-header">
              <h1>Calendario Financiero</h1>
              <div class="section-actions">
                <button type="button" id="add-event-btn" class="btn btn-primary">
  <i class="ph ph-plus" aria-hidden="true"></i> Nuevo Evento
</button>
                <button id="sync-google-calendar-btn" class="btn btn-secondary">
  <i class="ph ph-arrows-clockwise" aria-hidden="true"></i> Sincronizar Google
</button>
              </div>
            </div>
            
            <div class="calendar-container" style="margin-top: 0;">
              <!-- Calendar Navigation -->
              <div class="calendar-nav">
                <button id="prev-month" class="calendar-nav-btn">
                  <i class="ph ph-caret-left" aria-hidden="true"></i>
                </button>
                <h3 id="current-month-year">Enero 2025</h3>
                <button id="next-month" class="calendar-nav-btn">
                  <i class="ph ph-caret-right" aria-hidden="true"></i>
                </button>
                <div class="calendar-view-toggle">
                  <button class="view-btn active" data-view="month">Mes</button>
                  <button class="view-btn" data-view="week">Semana</button>
                  <button class="view-btn" data-view="agenda">Agenda</button>
                </div>
              </div>
              
              <!-- Calendar Grid -->
              <div class="calendar-grid" id="calendar-grid">
                <!-- Calendar will be generated here -->
              </div>
              
              <!-- Events List (Agenda View) -->
              <div class="calendar-agenda hidden" id="calendar-agenda">
                <div class="agenda-events" id="agenda-events">
                  <!-- Events will be loaded here -->
                </div>
              </div>
            </div>
            
            <!-- Event Types Legend -->
            <div class="event-legend">
              <h4>Tipos de Eventos</h4>
              <div class="legend-items">
                <div class="legend-item">
                  <div class="legend-color payment"></div>
                  <span>Pagos de Cuotas</span>
                </div>
                <div class="legend-item">
                  <div class="legend-color income"></div>
                  <span>Cobros</span>
                </div>
                <div class="legend-item">
                  <div class="legend-color card-close"></div>
                  <span>Cierre de Tarjetas</span>
                </div>
                <div class="legend-item">
                  <div class="legend-color reminder"></div>
                  <span>Recordatorios</span>
                </div>
                <div class="legend-item">
                  <div class="legend-color deadline"></div>
                  <span>Vencimientos</span>
                </div>
              </div>
            </div>
          </div>
        </section>
    </main>
  </div>

  <!-- Mobile Navigation -->
  <nav class="mobile-nav">
<a href="#" class="mobile-nav-item" data-section="dashboard">
  <div class="mobile-nav-icon"><i class="ph ph-chart-pie" aria-hidden="true"></i></div>
  <div class="mobile-nav-label">Inicio</div>
</a>
<a href="#" class="mobile-nav-item" data-section="transactions">
  <div class="mobile-nav-icon"><i class="ph ph-credit-card" aria-hidden="true"></i></div>
  <div class="mobile-nav-label">Gastos</div>
</a>
<a href="#" class="mobile-nav-item" data-section="budgets">
  <div class="mobile-nav-icon"><i class="ph ph-wallet" aria-hidden="true"></i></div>
  <div class="mobile-nav-label">Presupuestos</div>
</a>
<a href="#" class="mobile-nav-item" data-section="goals">
  <div class="mobile-nav-icon"><i class="ph ph-target" aria-hidden="true"></i></div>
  <div class="mobile-nav-label">Objetivos</div>
</a>
<a href="#" class="mobile-nav-item" data-section="reports">
  <div class="mobile-nav-icon"><i class="ph ph-chart-line-up" aria-hidden="true"></i></div>
  <div class="mobile-nav-label">Reportes</div>
</a>
  </nav>

  <!-- Modals -->
  
  <!-- View Incomes Modal -->
  <div id="view-incomes-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2><i class="ph ph-coins" aria-hidden="true"></i> Ingresos del Mes</h2>
        <button class="modal-close">
          <i class="ph ph-x" aria-hidden="true"></i>
        </button>
      </div>
      <div class="modal-body">
        <div id="all-incomes-list" class="all-incomes-list">
          <!-- Lista de todos los ingresos del mes -->
        </div>
      </div>
      <div class="modal-actions">
        <button type="button" class="btn btn-secondary modal-cancel">Cerrar</button>
      </div>
    </div>
  </div>

  <!-- View Installments Modal -->
  <div id="view-installments-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2><i class="ph ph-chart-bar" aria-hidden="true"></i> Cuotas Activas del Mes</h2>
        <button class="modal-close">
          <i class="ph ph-x" aria-hidden="true"></i>
        </button>
      </div>
      <div class="modal-body">
        <div id="installments-list" class="installments-list">
          <!-- Lista de cuotas del mes -->
        </div>
      </div>
      <div class="modal-actions">
        <button type="button" class="btn btn-secondary modal-cancel">Cerrar</button>
      </div>
    </div>
  </div>

  <!-- Add Spending Limit Modal -->
  <div id="add-spending-limit-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Agregar Límite de Gasto</h2>
        <button class="modal-close">
          <i class="ph ph-x" aria-hidden="true"></i>
        </button>
      </div>
      <form id="add-spending-limit-form" class="modal-form">
        <div class="form-group">
          <label for="limit-category">Categoría</label>
          <select id="limit-category" name="category" required>
            <option value="">Selecciona una categoría</option>
          </select>
        </div>
        <div class="form-group">
          <label for="limit-amount">Límite Mensual</label>
          <input type="number" id="limit-amount" name="amount" step="0.01" required />
        </div>
        <div class="form-group">
          <label for="limit-warning">Porcentaje de Alerta (%)</label>
          <input type="number" id="limit-warning" name="warningPercentage" min="50" max="100" value="80" />
          <small class="input-hint">Te alertaremos cuando alcances este porcentaje del límite</small>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn btn-secondary modal-cancel">Cancelar</button>
          <button type="submit" class="btn btn-primary">Crear Límite</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Modal: Editar Límite -->
<div id="edit-limit-modal" class="modal hidden">
  <div class="modal-content">
    <h2>Editar Límite de Gasto</h2>
    <form id="edit-limit-form">
      <label for="edit-limit-category">Categoría</label>
      <select id="edit-limit-category" name="category" required></select>

      <label for="edit-limit-amount">Monto límite</label>
      <input id="edit-limit-amount" type="number" step="0.01" name="amount" required>

      <div class="modal-actions">
        <button type="submit" class="btn-primary">Guardar cambios</button>
        <button type="button" class="btn-secondary" onclick="window.app.modals.hide('edit-limit-modal')">Cancelar</button>
      </div>
    </form>
  </div>
</div>

  
  <!-- Add Expense Modal -->
  <div id="add-expense-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Agregar Gasto</h2>
        <button class="modal-close">
          <i class="ph ph-x" aria-hidden="true"></i>
        </button>
      </div>
      <form id="add-expense-form" class="modal-form">
        <div class="form-group">
          <label for="expense-description">Descripción</label>
          <input type="text" id="expense-description" name="description" required />
        </div>
        <div class="form-group">
          <label for="expense-amount">Monto</label>
          <input type="number" id="expense-amount" name="amount" step="0.01" required />
        </div>
        <div class="form-group">
          <label for="expense-category">Categoría</label>
          <select id="expense-category" name="category" required>
            <option value="">Selecciona una categoría</option>
          </select>
        </div>
        <div class="form-group">
  <label for="expense-date">Fecha</label>
  <input type="date" id="expense-date" name="transactionDate" required>
</div>
<div class="form-group">
  <label>
    <input type="checkbox" id="expense-installments" name="hasInstallments" />
    Pagar en cuotas
  </label>
</div>

<div id="installments-group" class="form-group hidden">
  <label for="expense-installments-count">Número de cuotas</label>
  <input type="number" id="expense-installments-count" name="installmentsCount" min="2" max="24" />

  <label for="expense-installments-interest" style="margin-top:12px;">Interés total (%) <span class="text-muted">(opcional)</span></label>
  <input type="number" id="expense-installments-interest" name="installmentsInterest" min="0" step="0.01" placeholder="Ej: 20" />
  <small class="input-hint">Si lo dejás vacío o en 0%, se prorratea sin interés.</small>
</div>
        <div class="modal-actions">
          <button type="button" class="btn btn-secondary modal-cancel">Cancelar</button>
          <button type="submit" class="btn btn-primary">Agregar Gasto</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Modal: Editar Gasto -->
<div id="edit-expense-modal" class="modal hidden">
  <div class="modal-content">
    <h2>Editar Gasto</h2>
    <form id="edit-expense-form">
      <label for="edit-expense-description">Descripción</label>
      <input id="edit-expense-description" type="text" name="description" required>

      <label for="edit-expense-amount">Monto</label>
      <input id="edit-expense-amount" type="number" step="0.01" name="amount" required>

      <label for="edit-expense-category">Categoría</label>
      <select id="edit-expense-category" name="category" required></select>

      <label for="edit-expense-date">Fecha</label>
      <input id="edit-expense-date" type="date" name="transactionDate" required>

      <div class="modal-actions">
        <button type="submit" class="btn-primary">Guardar cambios</button>
        <button type="button" class="btn-secondary" onclick="window.app.modals.hide('edit-expense-modal')">Cancelar</button>
      </div>
    </form>
  </div>
</div>


  <!-- Add Income Modal -->
  <div id="add-income-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Agregar Ingreso</h2>
        <button class="modal-close">
          <i class="ph ph-x" aria-hidden="true"></i>
        </button>
      </div>
      <form id="add-income-form" class="modal-form">
        <div class="form-group">
          <label for="income-type">Tipo de Ingreso</label>
          <select id="income-type" name="type" required>
            <option value="fixed">Ingreso Fijo (Sueldo)</option>
            <option value="extra">Ingreso Extra</option>
          </select>
        </div>
        <div class="form-group">
          <label for="income-amount">Monto</label>
          <input type="number" id="income-amount" name="amount" step="0.01" required />
        </div>
        <div id="extra-income-group" class="hidden">
          <div class="form-group">
            <label for="income-description">Descripción</label>
            <input type="text" id="income-description" name="description" />
          </div>
          <div class="form-group">
            <label for="income-category">Categoría</label>
            <select id="income-category" name="category">
              <option value="freelance">Freelance</option>
              <option value="bonus">Bonus</option>
              <option value="investment">Inversión</option>
              <option value="other">Otro</option>
            </select>
          </div>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn btn-secondary modal-cancel">Cancelar</button>
          <button type="submit" class="btn btn-primary">Agregar Ingreso</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Add Goal Modal -->
  <div id="add-goal-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Nuevo Objetivo de Ahorro</h2>
        <button class="modal-close">
          <i class="ph ph-x" aria-hidden="true"></i>
        </button>
      </div>
      <form id="add-goal-form" class="modal-form">
        <div class="form-group">
          <label for="goal-name">Nombre del Objetivo</label>
          <input type="text" id="goal-name" name="name" required />
        </div>
        <div class="form-group">
          <label for="goal-target">Monto Objetivo</label>
          <input type="number" id="goal-target" name="targetAmount" step="0.01" required />
        </div>
        <div class="form-group">
          <label for="goal-current">Monto Actual (opcional)</label>
          <input type="number" id="goal-current" name="currentAmount" step="0.01" value="0" />
        </div>
        <div class="modal-actions">
          <button type="button" class="btn btn-secondary modal-cancel">Cancelar</button>
          <button type="submit" class="btn btn-primary">Crear Objetivo</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Edit Goal Modal -->
  <div id="edit-goal-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Editar Objetivo de Ahorro</h2>
        <button class="modal-close">
          <i class="ph ph-x" aria-hidden="true"></i>
        </button>
      </div>
      <form id="edit-goal-form" class="modal-form">
        <div class="form-group">
          <label for="edit-goal-name">Nombre del Objetivo</label>
          <input type="text" id="edit-goal-name" name="name" required />
        </div>
        <div class="form-group">
          <label for="edit-goal-target">Monto Objetivo</label>
          <input type="number" id="edit-goal-target" name="targetAmount" step="0.01" required />
        </div>
        <div class="form-group">
          <label for="edit-goal-current">Monto Actual</label>
          <input type="number" id="edit-goal-current" name="currentAmount" step="0.01" />
        </div>
        <div class="modal-actions">
          <button type="button" class="btn btn-secondary modal-cancel">Cancelar</button>
          <button type="submit" class="btn btn-primary">Guardar Cambios</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Add Money to Goal Modal -->
  <div id="add-money-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Agregar Dinero al Objetivo</h2>
        <button class="modal-close">
          <i class="ph ph-x" aria-hidden="true"></i>
        </button>
      </div>
      <div class="modal-body">
        <div class="goal-info">
          <h3 id="add-money-goal-name">Objetivo</h3>
          <p id="add-money-goal-progress">Progreso actual</p>
          <p id="add-money-max-amount" class="text-muted">Máximo disponible</p>
        </div>
        <form id="add-money-form" class="modal-form">
          <div class="form-group">
            <label for="add-money-amount">Monto a Agregar</label>
            <input type="number" id="add-money-amount" name="amount" step="0.01" min="0.01" required />
            <small class="input-hint">Ingresa el monto que quieres agregar a este objetivo</small>
          </div>
          <div class="modal-actions">
            <button type="button" class="btn btn-secondary modal-cancel">Cancelar</button>
            <button type="submit" class="btn btn-primary">Agregar Dinero</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Manage Categories Modal -->
  <div id="manage-categories-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2><i class="ph ph-tag" aria-hidden="true"></i> Gestionar Categorías</h2>
        <button class="modal-close">
          <i class="ph ph-x" aria-hidden="true"></i>
        </button>
      </div>
      <div class="modal-body">
        <div class="categories-management">
          <div class="add-category-section">
            <h3>Agregar Nueva Categoría</h3>
  <form id="add-category-form" class="category-form">
  <div class="form-group">
    <label for="category-name">Nombre</label>
    <input type="text" id="category-name" name="name" required />
  </div>
  <div class="form-group">
    <label for="category-icon">Icono</label>
    <select id="category-icon" name="icon" required>
      <option value="">Selecciona un icono</option>
      <option value='<i class="ph ph-fork-knife"></i>'>Comida</option>
      <option value='<i class="ph ph-car"></i>'>Transporte</option>
      <option value='<i class="ph ph-heart-straight"></i>'>Salud</option>
      <option value='<i class="ph ph-game-controller"></i>'>Ocio</option>
      <option value='<i class="ph ph-shopping-cart"></i>'>Compras</option>
      <option value='<i class="ph ph-house"></i>'>Servicios</option>
      <option value='<i class="ph ph-t-shirt"></i>'>Ropa</option>
      <option value='<i class="ph ph-book"></i>'>Educación</option>
      <option value='<i class="ph ph-laptop"></i>'>Tecnología</option>
      <option value='<i class="ph ph-soccer-ball"></i>'>Deportes</option>
      <option value='<i class="ph ph-airplane"></i>'>Viajes</option>
      <option value='<img src="/assets/svg/pedidosya-logo.svg" alt="PedidosYa" width="20" height="20" style="display: inline-block;">'>PedidosYa</option>
      <option value='<i class="ph ph-coffee"></i>'>Café</option>
      <option value='<i class="ph ph-music-note"></i>'>Música</option>
      <option value='<i class="ph ph-camera"></i>'>Fotografía</option>
      <option value='<i class="ph ph-gift"></i>'>Regalos</option>
      <option value='<i class="ph ph-paw-print"></i>'>Mascotas</option>
      <option value='<i class="ph ph-wrench"></i>'>Herramientas</option>
      <option value='<i class="ph ph-bank"></i>'>Banco</option>
      <option value='<i class="ph ph-dots-three"></i>'>Otros</option>
    </select>
  </div>
  <div class="modal-actions">
    <button type="button" class="btn btn-secondary modal-cancel">Cancelar</button>
    <button type="submit" class="btn btn-primary">
      <i class="ph ph-plus" aria-hidden="true"></i>
      Agregar Categoría
    </button>
  </div>
</form>
          
          <div class="categories-list-section">
            <h3>Categorías Existentes</h3>
            <div id="categories-management-list" class="categories-management-list">
              <!-- Categories will be loaded here -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
    <!-- Complete Profile Modal -->
    <div id="complete-profile-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Completa tu Perfil</h3>
          <p class="modal-subtitle">Para personalizar tu experiencia, necesitamos algunos datos adicionales</p>
        </div>
        <form id="complete-profile-form" class="modal-form">
          <div class="form-group">
            <label for="complete-first-name">Nombre *</label>
            <input type="text" id="complete-first-name" name="first_name" required>
          </div>
          <div class="form-group">
            <label for="complete-last-name">Apellido *</label>
            <input type="text" id="complete-last-name" name="last_name" required>
          </div>
          <div class="modal-actions">
            <button type="submit" class="btn btn-primary">
              <i class="ph ph-check-circle"></i> Completar Perfil
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Edit Profile Modal -->
    <div id="edit-profile-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Editar Perfil</h3>
          <button class="modal-close">
          <i class="ph ph-x" aria-hidden="true"></i>
        </button>
        </div>
        <form id="edit-profile-form" class="modal-form">
          <div class="form-group">
            <label for="edit-first-name">Nombre *</label>
            <input type="text" id="edit-first-name" name="first_name" required>
          </div>
          <div class="form-group">
            <label for="edit-last-name">Apellido *</label>
            <input type="text" id="edit-last-name" name="last_name" required>
          </div>
          <div class="modal-actions">
            <button type="button" class="btn btn-secondary modal-cancel">Cancelar</button>
            <button type="submit" class="btn btn-primary">
              <i class="ph ph-floppy-disk" aria-hidden="true"></i> Guardar Cambios
            </button>
          </div>
        </form>
      </div>
    </div>

  <!-- Import Data Modal -->
  <div id="import-data-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2><i class="ph ph-upload-simple" aria-hidden="true"></i> Importar Datos</h2>
        <button class="modal-close">
          <i class="ph ph-x" aria-hidden="true"></i>
        </button>
      </div>
      <div class="modal-body">
        <div class="import-section">
          <h3>Seleccionar Archivo CSV</h3>
          <div class="file-upload-area">
            <input type="file" id="import-file" accept=".csv" />
            <div class="file-upload-info">
              <p><strong>Formatos soportados automáticamente:</strong></p>
              <ul>
                <li><strong>FINZN Completo:</strong> tipo,descripcion,monto,categoria,fecha,mes,cuota_actual,total_cuotas,monto_original,es_recurrente</li>
                <li><strong>Gastos:</strong> descripcion,monto,categoria,fecha,cuota_actual,total_cuotas</li>
                <li><strong>Ingresos:</strong> tipo,monto,descripcion,fecha</li>
                <li><strong>Banco:</strong> fecha,descripcion,monto (detecta automáticamente gastos/ingresos)</li>
                <li><strong>Otros formatos:</strong> Se detectan automáticamente por contenido</li>
              </ul>
              <p><em>El sistema detecta automáticamente el formato y tipo de datos.</em></p>
            </div>
          </div>
          <div class="import-options">
            <label>
              <input type="radio" name="import-type" value="auto" checked />
              Detección Automática (Recomendado)
            </label>
            <label>
              <input type="radio" name="import-type" value="expenses" />
              Forzar como Gastos
            </label>
            <label>
              <input type="radio" name="import-type" value="incomes" />
              Forzar como Ingresos
            </label>
          </div>
        </div>
      </div>
      <div class="modal-actions">
        <button type="button" class="btn btn-secondary modal-cancel">Cancelar</button>
        <button type="button" id="process-import-btn" class="btn btn-primary">
          <i class="ph ph-download-simple" aria-hidden="true"></i>
          Importar Datos
        </button>
      </div>
    </div>
  </div>

  <!-- Generate AI Report Modal -->
  <div id="generate-ai-report-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2><i class="ph ph-robot" aria-hidden="true"></i> Generar Informe Financiero con IA</h2>
        <button class="modal-close">
          <i class="ph ph-x" aria-hidden="true"></i>
        </button>
      </div>
      <div class="modal-body">
        <div class="ai-report-options">
          <div class="form-group">
            <label for="report-period">Período del Informe</label>
            <select id="report-period" name="period">
              <option value="current">Mes Actual</option>
              <option value="last3">Últimos 3 Meses</option>
              <option value="last6">Últimos 6 Meses</option>
              <option value="year">Año Completo</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="report-focus">Enfoque del Informe</label>
            <select id="report-focus" name="focus">
              <option value="general">Análisis General</option>
              <option value="savings">Enfoque en Ahorros</option>
              <option value="expenses">Análisis de Gastos</option>
              <option value="budget">Optimización de Presupuesto</option>
              <option value="goals">Progreso hacia Objetivos</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="report-questions">Preguntas Específicas (Opcional)</label>
            <textarea id="report-questions" name="questions" rows="3" placeholder="¿Hay algo específico que te gustaría saber sobre tus finanzas?"></textarea>
          </div>
        </div>
        
        <div id="ai-report-result" class="ai-report-result hidden">
          <h3><i class="ph ph-chart-line" aria-hidden="true"></i> Tu Informe Financiero Personalizado</h3>
          <div id="ai-report-content" class="ai-report-content">
            <!-- El informe generado aparecerá aquí -->
          </div>
          <div class="ai-report-actions">
            <button id="download-report-btn" class="btn btn-secondary">
              <i class="ph ph-file-text" aria-hidden="true"></i>
              Descargar
            </button>
            <button id="share-report-btn" class="btn btn-secondary">
              <i class="ph ph-export" aria-hidden="true"></i>
              Compartir
            </button>
          </div>
        </div>
      </div>
      <div class="modal-actions">
        <button type="button" class="btn btn-secondary modal-cancel">Cancelar</button>
        <button type="button" id="generate-report-btn" class="btn btn-primary">
          <i class="ph ph-robot" aria-hidden="true"></i>
          Generar Informe
        </button>
      </div>
    </div>
  </div>

  <!-- Chat Widget -->
  <div id="chat-widget" class="chat-widget">
    <button id="chat-toggle" class="chat-toggle" title="Chat con asistente financiero">
      <img src="/robot-chat.png" alt="Chat" class="chat-toggle-icon" />
    </button>
    
    <div id="chat-window" class="chat-window hidden">
      <div class="chat-header">
        <div class="chat-header-info">
          <img src="/robot-chat.png" alt="Asistente" class="chat-header-avatar" />
          <div class="chat-header-text">
            <h3>Asistente FINZN</h3>
            <p>Tu consejero financiero</p>
          </div>
        </div>
        <button id="chat-close" class="chat-close">
          <i class="ph ph-x" aria-hidden="true"></i>
        </button>
      </div>
      
      <div id="chat-messages" class="chat-messages">
        <!-- Messages will be added here -->
      </div>
      
      <form id="chat-form" class="chat-form">
        <input type="text" id="chat-input" placeholder="Escribe tu pregunta..." autocomplete="off" />
        <button type="submit" class="chat-send" aria-label="Enviar">
  <i class="ph ph-paper-plane-tilt" aria-hidden="true"></i>
</button>
      </form>
    </div>
  </div>

  
<!-- Modal: Agregar Evento -->
<div id="add-event-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="add-event-title">
  <div class="modal-content">
    <div class="modal-header">
      <h2 id="add-event-title">Agregar Evento Financiero</h2>
      <button type="button" class="modal-close" aria-label="Cerrar">
        <i class="ph ph-x" aria-hidden="true"></i>
      </button>
    </div>

    <form id="add-event-form" class="modal-form">
      <div class="form-group">
        <label for="add-event-title-input">Título del Evento</label>
        <input id="add-event-title-input" name="title" type="text" class="form-control" required />
        <small class="input-hint">Ingresa un título descriptivo para el evento</small>
      </div>

      <div class="form-group">
        <label for="add-event-type">Tipo de Evento</label>
        <select id="add-event-type" name="type" class="form-control" required>
          <option value="">Selecciona un tipo</option>
          <option value="payment">💳 Pago de Cuota</option>
          <option value="income">💰 Cobro</option>
          <option value="card-close">🏦 Cierre de Tarjeta</option>
          <option value="reminder">⏰ Recordatorio</option>
          <option value="deadline">📅 Vencimiento</option>
        </select>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="add-event-date">Fecha</label>
          <input id="add-event-date" type="date" name="date" class="form-control" required />
        </div>
        <div class="form-group">
          <label for="add-event-time">Hora (opcional)</label>
          <input id="add-event-time" type="time" name="time" class="form-control" />
        </div>
      </div>

      <div class="form-group">
        <label for="add-event-amount">Monto (opcional)</label>
        <input id="add-event-amount" type="number" step="0.01" name="amount" class="form-control" placeholder="0.00" />
        <small class="input-hint">Monto asociado al evento financiero</small>
      </div>

      <div class="form-group">
        <label for="add-event-description">Descripción</label>
        <textarea id="add-event-description" name="description" class="form-control" rows="3" placeholder="Detalles adicionales del evento..."></textarea>
      </div>

      <div class="checkbox-group">
        <input type="checkbox" id="add-event-recurring" name="recurring" />
        <label for="add-event-recurring">Evento recurrente</label>
      </div>

      <div id="recurring-options" class="form-group hidden">
        <label for="add-event-frequency">Frecuencia</label>
        <select id="add-event-frequency" name="frequency" class="form-control">
          <option value="weekly">Semanal</option>
          <option value="monthly">Mensual</option>
          <option value="yearly">Anual</option>
        </select>
      </div>

      <div class="modal-actions">
        <button type="button" class="btn btn-secondary modal-cancel">Cancelar</button>
        <button type="submit" class="btn btn-primary">Guardar Evento</button>
      </div>
    </form>
  </div>
</div>

  <!-- Edit Calendar Event Modal -->
  <div id="edit-event-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Editar Evento</h2>
        <button class="modal-close">
          <i class="ph ph-x" aria-hidden="true"></i>
        </button>
      </div>
      <form id="edit-event-form" class="modal-form">
        <div class="form-group">
          <label for="edit-event-title">Título del Evento</label>
          <input type="text" id="edit-event-title" name="title" class="form-control" required />
        </div>
        
        <div class="form-group">
          <label for="edit-event-type">Tipo de Evento</label>
          <select id="edit-event-type" name="type" class="form-control" required>
            <option value="payment">💳 Pago de Cuota</option>
            <option value="income">💰 Cobro</option>
            <option value="card-close">🏦 Cierre de Tarjeta</option>
            <option value="reminder">⏰ Recordatorio</option>
            <option value="deadline">📅 Vencimiento</option>
          </select>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="edit-event-date">Fecha</label>
            <input type="date" id="edit-event-date" name="date" class="form-control" required />
          </div>
          <div class="form-group">
            <label for="edit-event-time">Hora</label>
            <input type="time" id="edit-event-time" name="time" class="form-control" />
          </div>
        </div>
        
        <div class="form-group">
          <label for="edit-event-amount">Monto</label>
          <input type="number" id="edit-event-amount" name="amount" step="0.01" class="form-control" placeholder="0.00" />
        </div>
        
        <div class="form-group">
          <label for="edit-event-description">Descripción</label>
          <textarea id="edit-event-description" name="description" rows="3" class="form-control" placeholder="Detalles del evento..."></textarea>
        </div>
        
        <div class="modal-actions">
          <button type="button" class="btn btn-secondary modal-cancel">Cancelar</button>
          <button type="submit" class="btn btn-primary">Guardar Cambios</button>
          <button type="button" id="delete-event-btn" class="btn btn-danger">Eliminar Evento</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Event Details Modal -->
  <div id="event-details-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="event-details-title">Detalles del Evento</h2>
        <button class="modal-close">
          <i class="ph ph-x" aria-hidden="true"></i>
        </button>
      </div>
      <div class="modal-body">
        <div id="event-details-content">
          <!-- Event details will be loaded here -->
        </div>
      </div>
      <div class="modal-actions">
        <button type="button" class="btn btn-secondary modal-cancel">Cerrar</button>
        <button type="button" id="edit-event-from-details" class="btn btn-primary">Editar</button>
      </div>
    </div>
  </div>

  <!-- Day Events Modal -->
  <div id="day-events-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="day-events-title">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="day-events-title">Eventos del Día</h2>
        <button type="button" class="modal-close" aria-label="Cerrar">
          <i class="ph ph-x" aria-hidden="true"></i>
        </button>
      </div>
      
      <div class="modal-body">
        <div id="day-events-date" class="day-events-date"></div>
        <div id="day-events-list" class="day-events-list">
          <!-- Events for the day will be populated here -->
        </div>
      </div>
      
      <div class="modal-actions">
        <button type="button" id="add-event-for-day" class="btn btn-primary">
          <i class="ph ph-plus"></i> Agregar Evento
        </button>
        <button type="button" id="delete-all-day-events" class="btn btn-danger">
          <i class="ph ph-trash"></i> Eliminar Todos
        </button>
        <button type="button" class="modal-cancel btn btn-secondary">Cerrar</button>
      </div>
    </div>
  </div>

  <!-- Google Calendar Sync Modal -->
  <div id="google-sync-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="google-sync-title">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="google-sync-title">Sincronización con Google Calendar</h2>
        <button type="button" class="modal-close" aria-label="Cerrar">
          <i class="ph ph-x" aria-hidden="true"></i>
        </button>
      </div>
      
      <div class="modal-body">
        <p class="modal-description">¿Qué deseas hacer con Google Calendar?</p>
        
        <div class="sync-action-buttons">
          <button id="connect-google-btn" class="btn btn-primary sync-action-btn">
            <i class="ph ph-key"></i>
            <div class="btn-content">
              <span>Conectar con Google</span>
              <small>Autorizar acceso a tu calendario</small>
            </div>
          </button>
          
          <button id="import-google-btn" class="btn btn-secondary sync-action-btn">
            <i class="ph ph-download"></i>
            <div class="btn-content">
              <span>Importar eventos</span>
              <small>Traer eventos desde Google Calendar</small>
            </div>
          </button>
          
          <button id="export-google-btn" class="btn btn-accent sync-action-btn">
            <i class="ph ph-upload"></i>
            <div class="btn-content">
              <span>Exportar eventos</span>
              <small>Enviar eventos a Google Calendar</small>
            </div>
          </button>
        </div>

        <div class="sync-settings">
          <div class="sync-setting-item">
            <label class="sync-toggle-label">
              <input type="checkbox" id="auto-sync-toggle" class="sync-toggle">
              <span class="sync-toggle-slider"></span>
              <div class="sync-toggle-content">
                <span class="sync-toggle-title">Sincronización Automática</span>
                <small class="sync-toggle-description">Sincronizar cambios automáticamente cada 5 minutos</small>
              </div>
            </label>
          </div>
        </div>
      </div>
      
      <div class="modal-actions">
        <button type="button" class="modal-cancel btn btn-secondary">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- Add Budget Modal -->
  <div id="add-budget-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Crear Nuevo Presupuesto</h2>
        <button class="modal-close">
          <i class="ph ph-x" aria-hidden="true"></i>
        </button>
      </div>
      <form id="add-budget-form" class="modal-form">
        <div class="form-group">
          <label for="budget-name">Nombre del Presupuesto</label>
          <input type="text" id="budget-name" name="name" required placeholder="Ej: Presupuesto Mensual Comida" />
        </div>
        <div class="form-group">
          <label for="budget-category">Categoría</label>
          <select id="budget-category" name="category" required>
            <option value="">Selecciona una categoría</option>
          </select>
        </div>
        <div class="form-group">
          <label for="budget-amount">Monto Límite</label>
          <input type="number" id="budget-amount" name="amount" step="0.01" required placeholder="0.00" />
          <small class="input-hint">Monto máximo que planeas gastar en esta categoría</small>
        </div>
        <div class="form-group">
          <label for="budget-start-date">Fecha de Inicio</label>
          <input type="date" id="budget-start-date" name="start_date" required />
        </div>
        <div class="form-group">
          <label for="budget-end-date">Fecha de Finalización</label>
          <input type="date" id="budget-end-date" name="end_date" required />
        </div>
        <div class="form-group">
          <label>
            <input type="checkbox" id="budget-ai-recommendations" name="ai_recommended" />
            Permitir recomendaciones de IA para este presupuesto
          </label>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn btn-secondary modal-cancel">Cancelar</button>
          <button type="submit" class="btn btn-primary">Crear Presupuesto</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Edit Budget Modal -->
  <div id="edit-budget-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Editar Presupuesto</h2>
        <button class="modal-close">
          <i class="ph ph-x" aria-hidden="true"></i>
        </button>
      </div>
      <form id="edit-budget-form" class="modal-form">
        <div class="form-group">
          <label for="edit-budget-name">Nombre del Presupuesto</label>
          <input type="text" id="edit-budget-name" name="name" required />
        </div>
        <div class="form-group">
          <label for="edit-budget-category">Categoría</label>
          <select id="edit-budget-category" name="category" required>
            <option value="">Selecciona una categoría</option>
          </select>
        </div>
        <div class="form-group">
          <label for="edit-budget-amount">Monto Límite</label>
          <input type="number" id="edit-budget-amount" name="amount" step="0.01" required />
        </div>
        <div class="form-group">
          <label for="edit-budget-start-date">Fecha de Inicio</label>
          <input type="date" id="edit-budget-start-date" name="start_date" required />
        </div>
        <div class="form-group">
          <label for="edit-budget-end-date">Fecha de Finalización</label>
          <input type="date" id="edit-budget-end-date" name="end_date" required />
        </div>
        <div class="form-group">
          <label>
            <input type="checkbox" id="edit-budget-ai-recommendations" name="ai_recommended" />
            Permitir recomendaciones de IA para este presupuesto
          </label>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn btn-secondary modal-cancel">Cancelar</button>
          <button type="submit" class="btn btn-primary">Guardar Cambios</button>
          <button type="button" id="delete-budget-btn" class="btn btn-danger">Eliminar</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Budget AI Insights Modal -->
  <div id="budget-ai-insights-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2><i class="ph ph-robot"></i> Análisis IA de Presupuestos</h2>
        <button class="modal-close">
          <i class="ph ph-x" aria-hidden="true"></i>
        </button>
      </div>
      <div class="modal-body">
        <div id="budget-ai-analysis-content" class="budget-ai-analysis-content">
          <!-- AI analysis will be loaded here -->
        </div>
      </div>
      <div class="modal-actions">
        <button type="button" class="btn btn-secondary modal-cancel">Cerrar</button>
        <button type="button" id="apply-ai-recommendations-btn" class="btn btn-primary">
          <i class="ph ph-sparkle" aria-hidden="true"></i>
          Aplicar Recomendaciones
        </button>
      </div>
    </div>
  </div>

  <!-- Load main application -->
  <script type="module" src="/src/main.js"></script>
  
</body>
</html>
